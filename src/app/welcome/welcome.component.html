<div class="welcome-container">
  <!-- Main Card -->
  <mat-card class="welcome-card">
    
    <!-- Header Section -->
    <div class="header-section">
      <div class="logo-container">
        <mat-icon class="logo-icon">school</mat-icon>
        <h1 class="school-name">Sri Jayadev Shiksha Kendra</h1>
      </div>
      <p class="tagline">Student Result Portal 2025-26</p>
    </div>

    <!-- Form Section -->
    <div class="form-section">
      <h2 class="form-title">
        <mat-icon>search</mat-icon> Check Your Result
      </h2>

      <!-- Error Messages -->
      <div *ngIf="rollNoError" class="error-message">
        <mat-icon>error</mat-icon>
        {{ rollNoError }}
      </div>

      <div *ngIf="dobError" class="error-message">
        <mat-icon>error</mat-icon>
        {{ dobError }}
      </div>

      <!-- Success Message -->
      <div *ngIf="foundStudent" class="success-message">
        <mat-icon>check_circle</mat-icon>
        Student found: {{ foundStudent.name }}
      </div>

      <!-- Roll Number Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Roll Number</mat-label>
        <input 
          matInput 
          [(ngModel)]="rollNo" 
          placeholder="e.g., 1A01, 2A05"
          maxlength="10"
          [disabled]="isSearching"
        >
        <mat-icon matPrefix>badge</mat-icon>
        <mat-hint>Enter your class and roll number</mat-hint>
      </mat-form-field>

      <!-- Date of Birth Input -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Date of Birth</mat-label>
        <input 
          matInput 
          type="text"
          inputmode="numeric"
          autocomplete="bday"
          placeholder="DD-MM-YYYY"
          maxlength="10"
          [(ngModel)]="dob"
          (ngModelChange)="onDobChange($event)"
          [disabled]="isSearching"
        >
        <mat-icon matPrefix>calendar_today</mat-icon>
        <mat-hint>Type DOB (DD-MM-YYYY). Example: 27022004 → 27-02-2004</mat-hint>
      </mat-form-field>

      <!-- View Result Button -->
      <button 
        mat-raised-button 
        color="primary" 
        class="view-btn"
        (click)="viewResult()" 
        [disabled]="isSearching || !rollNo || !hasValidDobInput()"
      >
        <mat-icon>description</mat-icon>
        {{ isSearching ? 'Searching...' : 'View Result' }}
      </button>

    </div>

    <!-- Info Section -->
    <div class="info-section">
      <mat-card class="info-card">
        <mat-card-content>
          <div class="info-item">
            <mat-icon>info</mat-icon>
            <span>Please enter your correct roll number and date of birth</span>
          </div>
          <!-- <div class="info-item">
            <mat-icon>warning</mat-icon>
            <span>Demo check ROLL NO- (1A01) &nbsp; DOB -(09-04-2011)</span>
          </div> -->
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Login Section -->
    <div class="login-section">
      <button 
        mat-raised-button 
        color="accent" 
        class="login-btn"
        routerLink="/login"
      >
        
        Login
      </button>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>© 2025 Sri Jayadev Shiksha Kendra. All rights reserved.</p>
      <p>
        Developed by
        <a href="https://github.com/narayan439" target="_blank" rel="noopener noreferrer">Narayan</a>
      </p>
     
    </div>

  </mat-card>

  <!-- Result Bot (floating) -->
  <button
    mat-fab
    color="primary"
    class="result-bot-fab"
    type="button"
    (click)="toggleBot()"
    aria-label="Open result bot"
  >
    <mat-icon>{{ botOpen ? 'close' : 'support_agent' }}</mat-icon>
  </button>

  <div *ngIf="botOpen" class="result-bot-panel" role="dialog" aria-label="Result Bot">
    <div class="bot-header">
      <div class="bot-title">
        <mat-icon>support_agent</mat-icon>
        <span>Result Bot</span>
      </div>
      <button mat-icon-button type="button" (click)="toggleBot()" aria-label="Close bot">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="bot-body">
      <div *ngFor="let msg of botMessages" class="bot-msg" [class.user]="msg.from === 'user'" [class.bot]="msg.from === 'bot'">
        <div class="bubble">{{ msg.text }}</div>
      </div>
    </div>

    <div class="bot-footer">
      <mat-form-field appearance="outline" class="bot-input">
        <mat-label>{{ botStep === 'roll' ? 'Enter Roll Number' : 'Enter DOB (DD-MM-YYYY)' }}</mat-label>
        <input
          matInput
          [(ngModel)]="botInput"
          (keyup.enter)="sendBot()"
          [disabled]="botLoading"
          [attr.inputmode]="botStep === 'dob' ? 'numeric' : null"
          [attr.autocomplete]="botStep === 'dob' ? 'bday' : null"
          [attr.maxlength]="botStep === 'dob' ? 10 : 20"
        />
      </mat-form-field>
      <button
        mat-raised-button
        color="primary"
        type="button"
        class="bot-send"
        (click)="sendBot()"
        [disabled]="botLoading || !botInput.trim()"
      >
        <mat-icon>{{ botLoading ? 'hourglass_empty' : 'send' }}</mat-icon>
        {{ botLoading ? 'Please wait' : 'Send' }}
      </button>
    </div>
  </div>
</div>